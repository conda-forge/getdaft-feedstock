{% set name = "getdaft" %}
{% set version = "0.6.1" %}
{% set bun_version = "1.2.23" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://github.com/Eventual-Inc/Daft/archive/refs/tags/v{{ version }}.tar.gz
    sha256: ab91ec480a7de04c02cbe4285c01e6b47b7d1afa37d7a1e1da72ee1ed839fd3c
    folder: daft

  # get bun executable this way, until it is available on conda-forge
  - url: https://github.com/oven-sh/bun/releases/download/bun-v{{ bun_version }}/bun-linux-x64.zip       # [linux and x86_64]
    sha256: cf0ed0a920799d576ffde4e0cae66d732bf23c2530407f26f59c7831dffe1f0e                             # [linux and x86_64]
  - url: https://github.com/oven-sh/bun/releases/download/bun-v{{ bun_version }}/bun-linux-aarch64.zip   # [linux and aarch64]
    sha256: 6a7a98c546d084a845deda62eb2a5b94a6a14a63ea81cf9186d46bf55bf910a9                             # [linux and aarch64]
  - url: https://github.com/oven-sh/bun/releases/download/bun-v{{ bun_version }}/bun-darwin-x64.zip      # [osx and x86_64]
    sha256: 9729c400e50bc3c86b6640e42af2ff5c057b5df3b27c93b40ed47c16b5e6a5e6                             # [osx and x86_64]
  - url: https://github.com/oven-sh/bun/releases/download/bun-v{{ bun_version }}/bun-darwin-aarch64.zip  # [osx and arm64] 
    sha256: 22f5fa3fff72b0d3b8e7e0f8051ecadf2e41920d474ac62db5279144809c9005                             # [osx and arm64] 
  - url: https://github.com/oven-sh/bun/releases/download/bun-v{{ bun_version }}/bun-windows-x64.zip     # [win and x86_64]
    sha256: 2171e94f9d1e0cd6d45bdced38e2dc821f4181a075ed80772e750b3298a9016d                             # [win and x86_64]
    folder: bun

build:
  skip: true  # [py<38]
  number: 0

requirements:
  build:
    - {{ stdlib('c') }}
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - {{ compiler('rust') }}
    - pkg-config
    - make
    - cargo-bundle-licenses
    - unzip  # [unix]
  host:
    - python
    - maturin >=1.5.0,<2.0.0
    - pip
    - openssl
    - xz-tools
  run:
    - python
    - pyarrow >=8.0.0
    - fsspec
    - tqdm
    - typing_extensions >=4.0.0

test:
  imports:
    - daft
  commands:
    - pip check
  requires:
    - pip

about:
  home: https://www.getdaft.io/
  dev_url: https://github.com/Eventual-Inc/Daft
  doc_url: https://www.getdaft.io/projects/docs/
  summary: Distributed Dataframes for Multimodal Data
  license: Apache-2.0
  license_file:
    - LICENSE
    - THIRDPARTY.yml

extra:
  recipe-maintainers:
    - thewchan
